## 前提条件
- 環境構築手順および `resources/` 以下の画面・JS資産は事前提供済みであり、ドキュメントでは主にバックエンド要件を定義する。
- Webルート（`routes/web.php`）は Laravel Blade を返す画面／ダウンロード機能を提供し、APIルート（`routes/api.php`）のみが API 仕様書の対象となる。
- 認証は Laravel Fortify を利用し、`/admin` および `/contacts/export` などは `auth` ミドルウェアで保護される。`/api/*` は現行仕様では公開APIとして動作する。

## 画面定義
| 画面ID | 画面名称 | パス | 備考 |
| --- | --- | --- | --- |
| SCR01 | お問い合わせフォーム | GET `/` | `ContactController@index` が提供済みフォームを表示。カテゴリ/タグ候補は画面ロード後に公開APIから取得する。`routes/web.php:18` |
| SCR02 | 入力内容確認・送信 | GET `/` 内部切替 | 同画面内で提供済みJSが確認レイアウトと送信処理を制御。バックエンドはバリデーション/APIレスポンス形式を維持する。 |
| SCR03 | お問い合わせ完了 | GET `/thanks` | `ContactController@thanks` が完了メッセージのみを返す。`routes/web.php:21` |
| SCR04 | 管理画面 | GET `/admin` | `auth` 必須。`AdminController@index` がUIを描画し、検索や詳細表示は公開APIを参照。`routes/web.php:25` |
| SCR05 | CSVダウンロード | GET `/contacts/export` | `auth` 必須。検索条件に基づき `ContactController@export` がCSVをストリーム返却。`routes/web.php:27` |
| SCR06 | 管理者ログイン | GET `/login` | Fortifyログインビュー。`app/Providers/FortifyServiceProvider.php` |
| SCR07 | 管理者登録 | GET `/register` | Fortify登録ビュー。`app/Providers/FortifyServiceProvider.php` |

## 機能要件
| EPIC名 | 機能ID | 機能名 | 概要（ビジネスロジック） | 入力条件/制約 | 期待される結果 | バックエンド挙動（箇条書き） | 関連ソース/責務 | 区分 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| お問い合わせ受付（ユーザー向け） | WF01 | フォーム表示 | `/` で問い合わせフォームを表示し入力を開始できる。 | - URL: GET `/`<br>- 認証: 不要 | フォームが正常描画される。 | - `ContactController@index` が `contact.index` を返す。<br>- BladeにCSRF/metaを埋め込む。<br>- カテゴリ/タグAPIが稼働していることを前提。 | - `routes/web.php:18`<br>- `app/Http/Controllers/ContactController@index`<br>- `resources/views/contact/*.blade.php` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF02 | 入力内容確認 | 入力内容を画面内で確認し名称付きで表示する。 | - WF01と同じ | 確認セクションで名称付き内容を確認し、修正へ戻れる。 | - `StoreContactRequest` と同一ルールを維持。<br>- `/api/categories` `/api/tags` がIDと名称を返す。<br>- APIレスポンス形式を変更しない。 | - `app/Http/Requests/StoreContactRequest`<br>- `resources/js/contact/*.js` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF03 | お問い合わせ送信 | 入力内容を送信して問い合わせとタグを登録する。 | - URL: POST `/api/contacts`<br>- 認証: 不要<br>- ルール: `StoreContactRequest` | 成功時 `/thanks` へ遷移し、失敗時はエラーメッセージが表示。 | - `POST /api/contacts` でJSON受領。<br>- バリデーション通過時に `contacts` と `contact_tag` を作成。<br>- 201/422 を返却。 | - `routes/api.php:23-26`<br>- `app/Http/Controllers/Api/ContactController@store`<br>- `app/Models/Contact` `Tag` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF04 | 完了画面表示 | 送信後に完了メッセージを表示しHOMEリンクを提供。 | - URL: GET `/thanks`<br>- 認証: 不要 | 完了メッセージとHOMEリンクが表示される。 | - `/thanks` ルートで `contact.thanks` を返す。 | - `routes/web.php:21`<br>- `app/Http/Controllers/ContactController@thanks` | 基本 |
| 問い合わせ運用（管理者向け） | AF01 | 問い合わせ検索・一覧 | 認証済み管理者が検索条件を指定し、7件/頁で一覧・ページングを確認。 | - 画面URL: GET `/admin`（auth必須）<br>- API: GET `/api/contacts`（公開）<br>- クエリ: keyword/gender/category_id/date/page | `data` と `meta.links` を含むJSONが返り、一覧・ページングが動作。 | - `/admin` を `auth` で保護。<br>- `IndexContactRequest` で入力検証。<br>- `Contact::with(...)->paginate(7)` を返し `ContactResource` で整形。 | - `routes/web.php:25`<br>- `app/Http/Controllers/AdminController@index`<br>- `app/Http/Controllers/Api/ContactController@index`<br>- `app/Http/Resources/ContactResource` | 基本 |
| 問い合わせ運用（管理者向け） | AF02 | 詳細参照＆削除 | 一覧から詳細を開き、不要な問い合わせを削除できる。 | - API: GET/DELETE `/api/contacts/{id}`（公開） | 詳細表示JSONにカテゴリ・タグが含まれ、削除時は204を返す。 | - `GET` で `ContactResource`（カテゴリ/タグ読み込み）を返す。<br>- `DELETE` で `contact_tag` を含め削除し204を返す。 | - `routes/api.php:27-29`<br>- `app/Http/Controllers/Api/ContactController@show,@destroy` | 基本 |
| 問い合わせ運用（管理者向け） | AF03 | CSVエクスポート | 認証済み管理者が検索条件に一致する問い合わせをCSVとして取得。 | - URL: GET `/contacts/export` + query（auth必須） | BOM付きCSVがダウンロードされる。 | - `contacts/export` を `auth` グループ内で提供。<br>- `ExportContactRequest` で入力検証。<br>- 条件に従い `Contact` を取得し CSV（ID/氏名/性別文言/メール/電話/住所/建物/カテゴリ/詳細/作成日時）を出力。 | - `routes/web.php:25-28`<br>- `app/Http/Controllers/ContactController@export`<br>- `app/Http/Requests/ExportContactRequest` | 応用 |
| 問い合わせ運用（管理者向け） | AF04 | タグマスタ管理 | 管理者がタグを追加・編集・削除し、フォーム内の候補を管理する。 | - API: `/api/tags` (GET/POST/PUT/DELETE) 公開<br>- ルール: `StoreTagRequest` / `UpdateTagRequest` | タグ一覧が常に最新化される。 | - バリデーションルールに従いCRUDを実行。<br>- `Tag::all()` を `TagResource` コレクションで返却。 | - `routes/api.php:32-38`<br>- `app/Http/Controllers/Api/TagController`<br>- `app/Http/Requests/StoreTagRequest` `UpdateTagRequest` | 応用 |
| 管理ユーザー認証・アカウント管理 | AU01 | 管理ユーザー登録 | Fortify登録画面から新しい管理ユーザーを作成。 | - URL: GET/POST `/register`<br>- ルール: `CreateNewUser` | 登録成功後 `/admin` へリダイレクト。 | - `CreateNewUser` が入力検証と保存を実施。<br>- Fortify設定で `home` を `/admin` に設定。 | - `app/Providers/FortifyServiceProvider`<br>- `app/Actions/Fortify/CreateNewUser`<br>- `resources/views/auth/register.blade.php` | 基本 |
| 管理ユーザー認証・アカウント管理 | AU02 | ログイン/ログアウト | Fortifyログイン画面から認証し、ログアウトできる。 | - URL: GET/POST `/login`, POST `/logout`<br>- RateLimit: 5/分 | ログイン成功で `/admin`、ログアウトでセッション破棄。 | - Fortifyログインビューを提供。<br>- `auth` ミドルウェアで `/admin` `/contacts/export` を保護。<br>- `/logout` POST を処理。 | - `app/Providers/FortifyServiceProvider`<br>- `resources/views/auth/login.blade.php`<br>- `routes/web.php` | 基本 |

## API仕様書（`routes/api.php` のみ）

### API01: カテゴリー一覧取得
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/categories` |
| メソッド | GET |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 問い合わせフォームで使用するカテゴリ一覧を取得する。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| なし | - | - | - | パラメータは受け付けない | - |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 200 OK | 取得成功 | `{ "data": [ { "id": 1, "content": "商品のお届けについて" }, ... ] }` |

**実装方法/補足**
- `Api\CategoryController@index`
- `Category::all()` を取得し `CategoryResource::collection()` で返却

---

### API02: お問い合わせ一覧取得
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/contacts` |
| メソッド | GET |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | お問い合わせ一覧を取得する。検索条件と7件/頁のページネーションに対応。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| keyword | string | 任意 | string, max:255 | 氏名またはメールアドレスの部分一致 | 田中 |
| gender | integer | 任意 | in:0,1,2,3 | 性別で絞り込み（0は全件） | 1 |
| category_id | integer | 任意 | exists:categories,id | 問い合わせ分類で絞り込み | 1 |
| date | string | 任意 | date (YYYY-MM-DD) | 作成日で絞り込み | 2024-01-15 |
| page | integer | 任意 | integer, min:1 | ページ番号（デフォルト:1） | 2 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 200 OK | 取得成功 | `{ "data": [...], "meta": { "current_page": 1, "per_page": 7, ... } }` |
| 422 Unprocessable Entity | バリデーションエラー | `{ "message": "...", "errors": { "gender": ["性別の値が不正です"] } }` |

**実装方法/補足**
- `Api\ContactController@index`
- `IndexContactRequest` でバリデーション
- `Contact::with(['category','tags'])`
- `keyword` は first_name/last_name/email を orWhere で検索
- `latest()->paginate(7)` でページネーション
- `ContactResource::collection()` で返却（`meta` 付き）

---

### API03: お問い合わせ登録
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/contacts` |
| メソッド | POST |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 問い合わせ内容を新規登録し、任意のタグを紐付ける。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| first_name | string | 必須 | string, max:255 | 姓 | 山田 |
| last_name | string | 必須 | string, max:255 | 名 | 太郎 |
| gender | integer | 必須 | in:1,2,3 | 性別 | 1 |
| email | string | 必須 | string, email, max:255 | メールアドレス | user@example.com |
| tel | string | 必須 | regex:/^[0-9]{10,11}$/ | 電話番号（ハイフン無し） | 0312345678 |
| address | string | 必須 | string, max:255 | 住所 | 東京都千代田区1-2-3 |
| building | string | 任意 | string, max:255 | 建物名 | サンプルビル101 |
| category_id | integer | 必須 | exists:categories,id | お問い合わせ分類ID | 1 |
| detail | string | 必須 | string, max:120 | お問い合わせ内容 | 商品について |
| tag_ids[] | integer | 任意 | array / exists:tags,id | 任意タグIDの配列 | 1 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 201 Created | 登録成功 | `{ "message": "Created" }`（実際は空ボディ） |
| 422 Unprocessable Entity | バリデーションエラー | `{ "message": "The given data was invalid.", "errors": { "email": ["メールアドレスの形式で入力してください"] } }` |

**実装方法/補足**
- `Api\ContactController@store`
- `StoreContactRequest` で入力検証
- `$contact = Contact::create($validated)` 後、`$contact->tags()->attach($tagIds)`
- 成功時は空レスポンスで201

---

### API04: お問い合わせ詳細取得
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/contacts/{contact}` |
| メソッド | GET |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 指定IDのお問い合わせ詳細（カテゴリ・タグ含む）を取得する。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| contact | integer (path) | 必須 | exists:contacts,id | 問い合わせID | 5 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 200 OK | `ContactResource` を返却 | `{ "data": { "id": 5, "first_name": "太郎", "category": { ... }, "tags": [...] } }` |
| 404 Not Found | IDが存在しない場合 | `{ "message": "No query results for model [Contact] 5" }` |

**実装方法/補足**
- `Api\ContactController@show`
- ルートモデルバインディングで `Contact $contact`
- `$contact->load(['category','tags'])` を `ContactResource` でラップ

---

### API05: お問い合わせ削除
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/contacts/{contact}` |
| メソッド | DELETE |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 指定IDのお問い合わせおよび紐付くタグを削除する。 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 204 No Content | 削除成功 | （空ボディ） |
| 404 Not Found | IDが存在しない場合 | `{ "message": "No query results for model [Contact] 5" }` |

**実装方法/補足**
- `Api\ContactController@destroy`
- `$contact->delete()`（`contact_tag` は外部キーの cascade により削除）

---

### API06: タグ一覧取得
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/tags` |
| メソッド | GET |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 問い合わせフォームおよび管理画面で使用するタグ一覧を取得する。 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 200 OK | 取得成功 | `{ "data": [ { "id": 1, "name": "質問" }, ... ] }` |

**実装方法/補足**
- `Api\TagController@index`
- `Tag::all()` を `TagResource::collection()` で返却

---

### API07: タグ登録
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/tags` |
| メソッド | POST |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 新規タグを登録する。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| name | string | 必須 | required, string, max:50, unique:tags,name | タグ名 | 要望 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 201 Created | 登録成功 | （空ボディ） |
| 422 Unprocessable Entity | バリデーションエラー | `{ "message": "The given data was invalid.", "errors": { "name": ["タグ名は既に使用されています"] } }` |

**実装方法/補足**
- `Api\TagController@store`
- `StoreTagRequest` で入力検証後 `Tag::create`

---

### API08: タグ更新
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/tags/{tag}` |
| メソッド | PUT |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 既存タグの名称を更新する。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| tag | integer (path) | 必須 | exists:tags,id | タグID | 3 |
| name | string | 必須 | required, string, max:50, unique:tags,name (対象ID除外) | 新しいタグ名 | ご意見 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 204 No Content | 更新成功 | （空ボディ） |
| 422 Unprocessable Entity | バリデーションエラー | `{ "message": "The given data was invalid.", "errors": { "name": ["タグ名は既に使用されています"] } }` |

**実装方法/補足**
- `Api\TagController@update`
- `UpdateTagRequest` でユニークチェック（`Rule::unique(...)->ignore($tagId)`）

---

### API09: タグ削除
**基本情報**
| 項目 | 内容 |
| --- | --- |
| エンドポイント | `/api/tags/{tag}` |
| メソッド | DELETE |
| 認証 | 不要 |
| 認可（ポリシー） | - |
| 説明 | 指定タグを削除する。 |

**リクエストパラメータ**
| パラメータ名 | 型 | 必須 | バリデーション | 説明 | 例 |
| --- | --- | --- | --- | --- | --- |
| tag | integer (path) | 必須 | exists:tags,id | タグID | 3 |

**レスポンス**
| ステータス | 説明 | レスポンスボディ例 |
| --- | --- | --- |
| 204 No Content | 削除成功 | （空ボディ） |
| 404 Not Found | IDが存在しない場合 | `{ "message": "No query results for model [Tag] 3" }` |

**実装方法/補足**
- `Api\TagController@destroy`
- `$tag->delete()`（`contact_tag` は外部キーの cascade により削除）

## データ要件
| ID | データ名 | 説明 | 管理すべき情報 | 必須/応用 | 備考 |
| --- | --- | --- | --- | --- | --- |
| DR01 | お問い合わせ情報 | エンドユーザーの問い合わせ内容。 | 氏名（姓/名）、性別（1/2/3）、メール、電話（10〜11桁）、住所、建物名、カテゴリID、本文（120字）、作成日時 | 必須 | `contacts` テーブル。`app/Models/Contact` |
| DR02 | カテゴリマスタ | 問い合わせ分類。 | content（<=255） | 必須 | `categories` テーブル。`database/seeders/CategorySeeder.php` |
| DR03 | タグマスタ | 問い合わせに付与する任意タグ。 | name（<=50, ユニーク） | 応用 | `tags` テーブル。`database/seeders/TagSeeder.php` |
| DR04 | お問い合わせ×タグ | 多対多付与。 | contact_id, tag_id（ユニーク組合せ） | 応用 | `contact_tag` テーブル。ユニーク制約あり。 |
| DR05 | 管理ユーザー | 管理画面へアクセスするアカウント。 | name, email(ユニーク), hashed password, remember_token, email_verified_at（two_factor列は現状未使用） | 必須 | `users` テーブル。`database/seeders/UserSeeder.php` |
| DR06 | 認証補助 | パスワードリセットトークン、APIトークン、失敗ジョブログ等 | password_reset_tokens, personal_access_tokens, failed_jobs | 応用 | Laravel標準マイグレーション。 |

## 基本機能向けバリデーション一覧
| 対象機能 | 入力項目 | ルール |
| --- | --- | --- |
| WF01/WF02/WF03 | `first_name`, `last_name` | 必須 / string / max:255 |
| WF01/WF02/WF03 | `gender` | 必須 / integer / in:1,2,3 |
| WF01/WF02/WF03 | `email` | 必須 / string / email / max:255 |
| WF01/WF02/WF03 | `tel` | 必須 / string / `regex:/^[0-9]{10,11}$/` |
| WF01/WF02/WF03 | `address` | 必須 / string / max:255 |
| WF01/WF02/WF03 | `building` | nullable / string / max:255 |
| WF01/WF02/WF03 | `category_id` | 必須 / integer / `exists:categories,id` |
| WF01/WF02/WF03 | `detail` | 必須 / string / max:120 |
| WF03 | `tag_ids[]` | array / integer / `exists:tags,id` |
| AF01 | `keyword` | nullable / string / max:255 |
| AF01 | `gender` | nullable / integer / in:0,1,2,3 |
| AF01 | `category_id` | nullable / integer / `exists:categories,id` |
| AF01 | `date` | nullable / date |
| AF04 | `name`（タグ） | 必須 / string / max:50 / unique |
| AF03 | エクスポート条件 | `keyword`<=255、`gender` in:0..3、`category_id` exists、`date` date |
| AU01 | `name` | 必須 / string / max:255 |
| AU01 | `email` | 必須 / email / max:255 / unique |
| AU01 | `password` | Fortify標準（8文字以上・確認用一致） |
| AU02 | `email`（ログイン） | 必須 / email / max:255 |
| AU02 | `password`（ログイン） | 必須 |

## テスト要件
| テストID | 対象機能 | 観点 | 手順/期待結果 |
| --- | --- | --- | --- |
| TC-WF01 | WF01 | 画面表示・初期ロード | `/` へアクセスし `contact.index` が表示。カテゴリ/タグは `/api/categories` `/api/tags` から取得される。 |
| TC-WF02 | WF02 | フロントバリデーション | 必須/形式エラー入力時にエラーメッセージが表示され確認画面へ遷移しない。正しい入力で確認画面に切替。 |
| TC-WF03 | WF03 | API送信・登録 | 確認画面から送信し、`POST /api/contacts` が201を返す。DBに `contacts`・`contact_tag` が作成され `/thanks` へ遷移。 |
| TC-WF04 | WF04 | Thanks画面 | `/thanks` で完了メッセージが表示され、HOMEリンクで `/` へ戻る。 |
| TC-AF01 | AF01 | 検索・ページング | ログイン後 `/admin` で条件検索するとURLクエリ＆ `GET /api/contacts` の結果が同期。`meta.links` に基づきページ遷移。 |
| TC-AF02 | AF02 | 詳細表示・削除 | 一覧の詳細ボタンで `GET /api/contacts/{id}` が表示され、削除ボタンで `DELETE /api/contacts/{id}` が204を返し再描画。 |
| TC-AF03 | AF03 | CSVエクスポート | `/admin` で条件指定後エクスポートすると `/contacts/export` が同条件で呼ばれ、BOM付きCSVがダウンロードされる。 |
| TC-AF04-1 | AF04 | タグ登録 | タグ名入力→追加で `POST /api/tags` が201。重複時422。 |
| TC-AF04-2 | AF04 | タグ編集/削除 | 編集→`PUT /api/tags/{id}` が204、削除→`DELETE /api/tags/{id}` が204。 |
| TC-AU01 | AU01 | 管理者登録 | `/register` で正しく入力するとユーザーが作成され `/admin` へ。未入力や重複でエラー表示。 |
| TC-AU02 | AU02 | ログイン/ログアウト | `/login` で認証成功後 `/admin` を表示し、ログアウトボタンでセッション破棄。 |

## テーブル仕様書

### usersテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | users | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2014_10_12_000000_create_users_table.php:14` |
| 2 | users | name | varchar(255) |  | :white_check_mark: |  | 管理者氏名 |
| 3 | users | email | varchar(255) unique |  | :white_check_mark: |  | ログインID |
| 4 | users | email_verified_at | timestamp |  |  |  | nullable |
| 5 | users | password | varchar(255) |  | :white_check_mark: |  | ハッシュ保存 |
| 6 | users | two_factor_secret | text |  |  |  | 現状未使用 |
| 7 | users | two_factor_recovery_codes | text |  |  |  | 現状未使用 |
| 8 | users | two_factor_confirmed_at | timestamp |  |  |  | 現状未使用 |
| 9 | users | remember_token | varchar(100) |  |  |  |  |
| 10 | users | created_at | timestamp |  |  |  | timestamps |
| 11 | users | updated_at | timestamp |  |  |  | timestamps |

### categoriesテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | categories | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_040042_create_categories_table.php` |
| 2 | categories | content | varchar(255) |  | :white_check_mark: |  | カテゴリ名 |
| 3 | categories | created_at | timestamp |  |  |  |  |
| 4 | categories | updated_at | timestamp |  |  |  |  |

### contactsテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | contacts | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_040043_create_contacts_table.php` |
| 2 | contacts | category_id | bigint unsigned |  | :white_check_mark: | categories.id | onDelete cascade |
| 3 | contacts | first_name | varchar(255) |  | :white_check_mark: |  | 姓 |
| 4 | contacts | last_name | varchar(255) |  | :white_check_mark: |  | 名 |
| 5 | contacts | gender | tinyint |  | :white_check_mark: |  | 1:男性,2:女性,3:その他 |
| 6 | contacts | email | varchar(255) |  | :white_check_mark: |  |  |
| 7 | contacts | tel | varchar(11) |  | :white_check_mark: |  | 10〜11桁 |
| 8 | contacts | address | varchar(255) |  | :white_check_mark: |  |  |
| 9 | contacts | building | varchar(255) |  |  |  | nullable |
| 10 | contacts | detail | varchar(120) |  | :white_check_mark: |  |  |
| 11 | contacts | created_at | timestamp |  |  |  |  |
| 12 | contacts | updated_at | timestamp |  |  |  |  |

### tagsテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | tags | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_042329_create_tags_table.php` |
| 2 | tags | name | varchar(50) unique |  | :white_check_mark: |  | タグ名 |
| 3 | tags | created_at | timestamp |  |  |  |  |
| 4 | tags | updated_at | timestamp |  |  |  |  |

### contact_tagテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | contact_tag | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_042338_create_contact_tag_table.php` |
| 2 | contact_tag | contact_id | bigint unsigned |  | :white_check_mark: | contacts.id | onDelete cascade |
| 3 | contact_tag | tag_id | bigint unsigned |  | :white_check_mark: | tags.id | onDelete cascade |
| 4 | contact_tag | created_at | timestamp |  |  |  |  |
| 5 | contact_tag | updated_at | timestamp |  |  |  |  |
| 6 | contact_tag | (制約) | unique(contact_id, tag_id) |  |  |  | 重複付与防止 |

### その他（標準テーブル）
- `password_reset_tokens`, `personal_access_tokens`, `failed_jobs` はLaravel標準マイグレーションに従う。
