## 前提条件
- 環境構築手順およびBlade/JS/CSSなど `resources/` 以下の実装は事前に提供されているため、本書では挙動の要約とバックエンド要件に主眼を置く。
- 画面レイアウトやバリデーションメッセージ等のフロント実装は既存資産を参照し、追加開発対象は原則としてLaravelバックエンド/API層である。
- 認証には Laravel Fortify を利用し、アプリ内の Web/API ルートから使用する。

## 画面定義
| 画面ID | 画面名称 | パス | 備考 |
| --- | --- | --- | --- |
| SCR01 | お問い合わせフォーム | GET `/` | UIは提供済み。バックエンドは `ContactController@index` でビューを返し、カテゴリ／タグ候補を取得するAPIが稼働していることが前提。`routes/web.php:18` |
| SCR02 | 入力内容確認／送信ボックス | GET `/`（同画面内切替） | 同一ビュー内で提供済みJSが確認表示や送信ボタン制御を行う。APIレスポンス形式とバリデーション定義をバックエンド側で保証する。 |
| SCR03 | お問い合わせ完了 | GET `/thanks` | 完了メッセージ表示用ビュー。`ContactController@thanks` が提供済みレイアウトを返却するのみ。`routes/web.php:21` |
| SCR04 | 管理画面 | GET `/admin` | 認証必須。提供済みUIがAJAXで `/api/contacts` など公開APIへアクセスする構成のため、バックエンドは `/admin` への `auth` 保護とAPIのレスポンス統一を担う。`routes/web.php:25` |
| SCR05 | 管理者ログイン | GET `/login` | Fortify標準画面（提供済み）。Fortify設定でビューを返すのみ。`app/Providers/FortifyServiceProvider.php:38` |
| SCR06 | 管理者登録 | GET `/register` | Fortify標準画面（提供済み）。登録処理はFortifyアクションにより行われる。`app/Providers/FortifyServiceProvider.php:44` |

## 機能要件
| EPIC名 | 機能ID | 機能名 | 概要（ビジネスロジック） | 入力条件/制約 | 期待される結果 | バックエンド挙動（箇条書き） | 関連ソース/責務 | 区分 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| お問い合わせ受付（ユーザー向け） | WF01 | フォーム表示・初期入力 | ユーザーが `/` で問い合わせフォーム全項目を閲覧し、入力を開始できる。 | - URL: GET `/`<br>- 認証: 不要 | 画面がエラーなく表示され、入力できる。 | - `/` ルートで `contact.index` を返す。<br>- CSRF/metaタグをBladeに埋め込む。<br>- カテゴリ/タグ取得API（公開）が稼働していること。 | - `routes/web.php:18`<br>- `app/Http/Controllers/ContactController@index`<br>- `resources/views/contact/*.blade.php` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF02 | 入力内容確認 | 入力値を画面内で確認し、カテゴリ・タグ名称を含めて表示する。 | - WF01と同じ | 確認画面で名称付きの値を確認し、修正に戻れる。 | - `StoreContactRequest` と同一ルールを維持（JSと同期）。<br>- `/api/categories` `/api/tags` でIDに対応する名称を返す。<br>- APIレスポンス形式を変更しない。 | - `app/Http/Requests/StoreContactRequest`<br>- `resources/js/contact/*.js` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF03 | お問い合わせ送信 | ユーザーが入力内容を送信し、問い合わせと任意タグを登録できる。 | - URL: POST `/api/contacts`<br>- 認証: 不要<br>- バリデーション: `StoreContactRequest` | 成功時 Thanks 画面へ遷移し、失敗時はエラー表示。 | - `POST /api/contacts` でJSON受領。<br>- バリデーション通過時に `contacts` と `contact_tag` を作成。<br>- 201/422 を適切に返却。 | - `routes/api.php:25`<br>- `app/Http/Controllers/Api/ContactController@store`<br>- `app/Models/Contact` `Tag` | 基本 |
| お問い合わせ受付（ユーザー向け） | WF04 | 完了画面表示 | 送信後に完了メッセージを提示し、HOMEへ戻す導線を提供する。 | - URL: GET `/thanks`<br>- 認証: 不要 | メッセージとHOMEリンクが表示される。 | - `/thanks` ルートで `contact.thanks` を返す。 | - `routes/web.php:21`<br>- `app/Http/Controllers/ContactController@thanks` | 基本 |
| 問い合わせ運用（管理者向け） | AF01 | 問い合わせ検索・一覧 | 管理者が認証後の画面で条件検索し、7件ごとの一覧とページ切り替えができる。 | - 画面URL: GET `/admin`（要ログイン）<br>- API: GET `/api/contacts`（公開）<br>- クエリ: keyword/gender/category_id/date/page | JSON結果に `data` と `meta.links` が含まれ、UIが描画される。 | - `/admin` は `auth` ミドルウェアで保護。<br>- `IndexContactRequest` で入力検証。<br>- `Contact::with(...)->paginate(7)` を返却し、`meta` に現在ページ/linksを含める。 | - `routes/web.php:25`<br>- `app/Http/Controllers/AdminController@index`<br>- `app/Http/Controllers/Api/ContactController@index`<br>- `app/Http/Resources/ContactResource` | 基本 |
| 問い合わせ運用（管理者向け） | AF02 | 詳細参照＆削除 | 一覧から詳細を閲覧し、不要な問い合わせを削除できる。 | - API: GET/DELETE `/api/contacts/{id}`（公開） | 詳細表示用JSONにカテゴリ・タグが含まれ、削除成功時204を返す。 | - `GET` で `ContactResource`（カテゴリ/タグ読み込み）を返す。<br>- `DELETE` で `contact_tag` も含め削除し204を返す。 | - `routes/api.php:27-29`<br>- `app/Http/Controllers/Api/ContactController@show,@destroy` | 基本 |
| 問い合わせ運用（管理者向け） | AF03 | CSVエクスポート | 検索条件に一致する問い合わせ一覧をCSVとしてダウンロードできる。 | - URL: GET `/contacts/export` + query（auth必須） | BOM付きCSVがダウンロードされる。 | - `auth` グループ下で `/contacts/export` を提供。<br>- `ExportContactRequest` で条件検証。<br>- 条件に従い `Contact` を取得し、CSV列（ID/氏名/性別文言/メール/電話/住所/建物/カテゴリ/詳細/作成日時）を出力。 | - `routes/web.php:25-28`<br>- `app/Http/Controllers/ContactController@export`<br>- `app/Http/Requests/ExportContactRequest` | 応用 |
| 問い合わせ運用（管理者向け） | AF04 | タグマスタ管理 | 管理者がタグを追加・更新・削除し、問い合わせフォームの候補を管理できる。 | - API: `/api/tags` (GET/POST/PUT/DELETE) 公開<br>- name必須/<=50/ユニーク | タグ一覧が常に最新化される。 | - `StoreTagRequest` / `UpdateTagRequest` で入力を検証。<br>- 作成/更新/削除で204/201/422を正しく返す。<br>- `Tag::all()` を `TagResource` で返す。 | - `routes/api.php:32-38`<br>- `app/Http/Controllers/Api/TagController`<br>- `app/Http/Requests/StoreTagRequest` `UpdateTagRequest` | 応用 |
| 管理ユーザー認証・アカウント管理 | AU01 | 管理ユーザー登録 | 管理者がFortifyの登録画面から新しい管理ユーザーを作成できる。 | - URL: GET/POST `/register`<br>- バリデーション: `CreateNewUser` | 作成後 `/admin` に遷移。 | - Fortify `CreateNewUser` で入力検証・ハッシュ化保存。<br>- ユーザー作成後 `config/fortify.php` の `home` に従って `/admin` へ。 | - `app/Providers/FortifyServiceProvider`<br>- `app/Actions/Fortify/CreateNewUser`<br>- `resources/views/auth/register.blade.php` | 基本 |
| 管理ユーザー認証・アカウント管理 | AU02 | ログイン/ログアウトと保護 | 管理者がログインし、保護された画面を利用し、ログアウトできる。 | - URL: GET/POST `/login`, POST `/logout`<br>- RateLimit:5/分 | ログイン成功で `/admin`、ログアウトでセッション破棄。 | - Fortifyログインビューを提供。<br>- `auth` ミドルウェアで `/admin` `/contacts/export` を保護。<br>- `/logout` POST をハンドリング。 | - `app/Providers/FortifyServiceProvider`<br>- `resources/views/auth/login.blade.php`<br>- `routes/web.php` | 基本 |

## API仕様書

### API01: カテゴリー一覧取得
- **概要**: フォーム用カテゴリ候補を全件取得。`routes/api.php:19` `app/Http/Controllers/Api/CategoryController.php:11`
- **エンドポイント**: `GET /api/categories`
- **メソッド**: GET
- **認証**: 不要
- **認可**: -
- **説明**: `CategoryResource` の配列を返却。
- **リクエストパラメータ**: なし
- **レスポンス**:
  - 200 OK
    ```json
    { "data": [ { "id": 1, "content": "商品のお届けについて" } ] }
    ```
- **その他**: コレクション形式。`resources/js/contact/category-select-loader.js:7` で利用。

### API02: お問い合わせ一覧取得
- **概要**: 管理画面用に検索/ページネーション付きで問い合わせ一覧を取得。`routes/api.php:23` `app/Http/Controllers/Api/ContactController.php:14`
- **エンドポイント**: `GET /api/contacts`
- **メソッド**: GET
- **認証**: 不要（現状フロントJSのみから呼び出し・要件化する際はauth追加想定）
- **認可**: -
- **説明**: `ContactResource` コレクションを7件/頁で返し、`meta` にページ情報を含む。
- **リクエストパラメータ**:
  - `keyword` string 任意／max:255（部分一致。氏名・メールを対象）
  - `gender` integer 任意／in:0,1,2,3（0は全件）
  - `category_id` integer 任意／`categories.id` が存在
  - `date` string 任意／日付形式（YYYY-MM-DD）
  - `page` integer 任意／1以上（Laravelのページネータパラメータ）
- **レスポンス**:
  - 200 OK
    ```json
    {
      "data": [
        {
          "id": 12,
          "category": { "id": 3, "content": "商品トラブル" },
          "tags": [ { "id": 1, "name": "質問" } ],
          "first_name": "山田",
          "last_name": "太郎",
          "gender": 1,
          "email": "example@example.com",
          "tel": "0312345678",
          "address": "東京都...",
          "building": "サンプルビル",
          "detail": "..."
        }
      ],
      "meta": { "current_page": 1, "per_page": 7, "total": 20 }
    }
    ```
- **その他**: バリデーションは `IndexContactRequest`（`app/Http/Requests/IndexContactRequest.php:22`）。

### API03: お問い合わせ登録
- **概要**: フォーム入力を新規登録し、タグを中間テーブルに紐付ける。`routes/api.php:25` `app/Http/Controllers/Api/ContactController.php:44`
- **エンドポイント**: `POST /api/contacts`
- **メソッド**: POST
- **認証**: 不要
- **認可**: -
- **説明**: `StoreContactRequest` で検証後 `contacts` と `contact_tag` を作成。
- **リクエストパラメータ（JSON Body）**:
  - `first_name` string 必須／max:255
  - `last_name` string 必須／max:255
  - `gender` integer 必須／in:1,2,3
  - `email` string 必須／メール形式／max:255
  - `tel` string 必須／正規表現 `^[0-9]{10,11}$`
  - `address` string 必須／max:255
  - `building` string 任意／max:255
  - `category_id` integer 必須／`categories.id` 存在
  - `detail` string 必須／max:120
  - `tag_ids` array 任意／要素はinteger `exists:tags,id`
- **レスポンス**:
  - 201 Created （ボディなし）
  - 422 Validation Error（`errors` 包含）
- **その他**: 成功後フロントが `/thanks` へ遷移（`resources/js/contact/index.js:404`）。

### API04: お問い合わせ詳細取得
- **概要**: 単一問い合わせをカテゴリ・タグ付きで返却。`routes/api.php:27` `app/Http/Controllers/Api/ContactController.php:59`
- **エンドポイント**: `GET /api/contacts/{contact}`
- **メソッド**: GET
- **認証**: 不要
- **認可**: -
- **説明**: 指定IDの `ContactResource` を返し、`category` と `tags` を eager load。
- **リクエストパラメータ**: `contact` path integer（存在するID）
- **レスポンス**: 200 OK + ContactResource
- **その他**: 管理モーダルが利用（`resources/js/admin/contact-detail-modal.js:77`）。

### API05: お問い合わせ削除
- **概要**: 問い合わせ1件を削除し、中間テーブルもcascade。`routes/api.php:29` `app/Http/Controllers/Api/ContactController.php:64`
- **エンドポイント**: `DELETE /api/contacts/{contact}`
- **メソッド**: DELETE
- **認証**: 不要
- **認可**: -
- **レスポンス**: 204 No Content（成功）
- **その他**: フロントはconfirm後に呼び出し（`resources/js/admin/contact-detail-modal.js:67`）。

### API06: タグ一覧取得
- **概要**: タグマスタを全件取得。`routes/api.php:32` `app/Http/Controllers/Api/TagController.php:11`
- **エンドポイント**: `GET /api/tags`
- **メソッド**: GET
- **認証**: 不要
- **認可**: -
- **レスポンス**: 200 OK
  ```json
  { "data": [ { "id": 1, "name": "質問" } ] }
  ```
- **その他**: フォーム・管理画面双方で使用（`resources/js/contact/tag-select-loader.js:7`、`resources/js/admin/tag-management.js:77`）。

### API07: タグ登録
- **概要**: 新規タグを登録。`routes/api.php:34` `app/Http/Controllers/Api/TagController.php:17`
- **エンドポイント**: `POST /api/tags`
- **メソッド**: POST
- **認証**: 不要
- **認可**: -
- **リクエスト**: `name` string 必須／max:50／ユニーク（`app/Http/Requests/StoreTagRequest.php:14`）
- **レスポンス**: 201 Created（ボディなし）
- **その他**: 422でメッセージ返却、画面は`errorBox`に表示。

### API08: タグ更新
- **概要**: 既存タグの名称を更新。`routes/api.php:36` `app/Http/Controllers/Api/TagController.php:21`
- **エンドポイント**: `PUT /api/tags/{tag}`
- **メソッド**: PUT
- **認証**: 不要
- **認可**: -
- **リクエスト**: `name` string 必須／max:50／ユニーク（指定ID除外）。`app/Http/Requests/UpdateTagRequest.php:15`
- **レスポンス**: 204 No Content
- **その他**: 編集対象はJSが管理（`resources/js/admin/tag-management.js:131`）。

### API09: タグ削除
- **概要**: タグを削除し、pivotもcascade。`routes/api.php:38` `app/Http/Controllers/Api/TagController.php:27`
- **エンドポイント**: `DELETE /api/tags/{tag}`
- **メソッド**: DELETE
- **レスポンス**: 204 No Content
- **その他**: 使用中タグ削除時もDBが`contact_tag`をcascade削除。

### API10: お問い合わせCSVエクスポート
- **概要**: 管理画面から検索条件を指定してCSVをダウンロード。`routes/web.php:27` `app/Http/Controllers/ContactController.php:20`
- **エンドポイント**: `GET /contacts/export`
- **メソッド**: GET
- **認証**: 必須（`auth` middleware）
- **認可**: -
- **リクエストパラメータ**: `keyword` (string<=255), `gender` (0-3), `category_id` (exists), `date` (date) ― `app/Http/Requests/ExportContactRequest.php:22`
- **レスポンス**:
  - 200 OK + `text/csv`; ファイル名 `contacts_YYYYMMDD_HHMMSS.csv`
  - 各行: `id, 氏名, 性別名, email, tel, address, building, category, detail, created_at`
- **その他**: Excel互換のBOMを先頭出力（`app/Http/Controllers/ContactController.php:47`）。

## データ要件
| ID | データ名 | 説明 | 管理すべき情報 | 必須/応用 | 備考 |
| --- | --- | --- | --- | --- | --- |
| DR01 | お問い合わせ情報 | エンドユーザーから送信された問い合わせ内容。 | 氏名（姓・名）、性別（1:男性/2:女性/3:その他）、メール、電話（10〜11桁）、住所、建物名、カテゴリID、本文（120字）、作成日時。 | 必須 | テーブル/カラム仕様は `database/migrations/2026_02_10_040043_create_contacts_table.php:14`、モデルは `app/Models/Contact.php:18`。 |
| DR02 | カテゴリマスタ | 問い合わせ分類の固定値。 | content（255字以内）、種別ID。 | 必須 | Seederで5件投入（`database/seeders/CategorySeeder.php:15`）。 |
| DR03 | タグマスタ | 問い合わせに任意で付与するラベル。 | name（<=50文字ユニーク）。 | 応用 | CRUD APIと管理画面で維持（`database/migrations/2026_02_10_042329_create_tags_table.php:14`、`resources/js/admin/tag-management.js:71`）。 |
| DR04 | お問い合わせ×タグ関連 | 多対多付与の保持。 | contact_id, tag_id, timestamp、組み合わせユニーク。 | 応用 | Pivot定義 `database/migrations/2026_02_10_042338_create_contact_tag_table.php:14`。 |
| DR05 | 管理ユーザー | 管理画面へアクセスできるアカウント。 | name, email(ユニーク), hashed password, remember_token, email_verified_at（two_factor系カラムは現状未使用） | 必須 | Fortifyが使用。`database/migrations/2014_10_12_000000_create_users_table.php:14`、`2014_10_12_200000_add_two_factor_columns_to_users_table.php:14`。初期ユーザーはSeeder（`database/seeders/UserSeeder.php:13`）。 |
| DR06 | 認証補助データ | パスワードリセット、APIトークン、ジョブ失敗記録。 | password_reset_tokens(email, token, created_at)、personal_access_tokens(多態)、failed_jobsログ。 | 応用 | 標準Laravel機能。`database/migrations/2014_10_12_100000_create_password_reset_tokens_table.php:12`、`2019_12_14_000001_create_personal_access_tokens_table.php:12`、`2019_08_19_000000_create_failed_jobs_table.php:12`。 |

## 基本機能向けバリデーション一覧
| 対象機能 | 入力項目 | ルール |
| --- | --- | --- |
| WF01/ WF02/ WF03 | `first_name`, `last_name` | 必須 / string / max:255（`StoreContactRequest`、`resources/js/contact/index.js`） |
| WF01/ WF02/ WF03 | `gender` | 必須 / integer / in:1,2,3（同上） |
| WF01/ WF02/ WF03 | `email` | 必須 / string / email / max:255 |
| WF01/ WF02/ WF03 | `tel` | 必須 / string / `regex:/^[0-9]{10,11}$/` |
| WF01/ WF02/ WF03 | `address` | 必須 / string / max:255 |
| WF01/ WF02/ WF03 | `building` | nullable / string / max:255 |
| WF01/ WF02/ WF03 | `category_id` | 必須 / integer / `exists:categories,id` |
| WF01/ WF02/ WF03 | `detail` | 必須 / string / max:120 |
| WF03 | `tag_ids[]` | array / 各要素 integer / `exists:tags,id` |
| AF01 | `keyword` | nullable / string / max:255（`IndexContactRequest`） |
| AF01 | `gender` | nullable / integer / in:0,1,2,3 |
| AF01 | `category_id` | nullable / integer / `exists:categories,id` |
| AF01 | `date` | nullable / date |
| AF04 | `name`（タグ） | 必須 / string / max:50 / ユニーク（`StoreTagRequest`、`UpdateTagRequest`） |
| AF03 | エクスポート条件 | `keyword` string<=255、`gender` in:0,1,2,3、`category_id` exists、`date` date（`ExportContactRequest`） |
| AU01 | `name` | 必須 / string / max:255（`CreateNewUser`） |
| AU01 | `email` | 必須 / email / max:255 / ユニーク |
| AU01 | `password` | Fortify既定（8文字以上・文字種組合せ）/ confirmed |
| AU02 | `email`（ログイン） | 必須 / email / max:255 |
| AU02 | `password`（ログイン） | 必須 / current_password検証（更新時） |

## テスト要件
| テストID | 対象機能 | 観点 | 手順/期待結果 |
| --- | --- | --- | --- |
| TC-WF01 | WF01 | 画面表示・初期ロード | `/` へアクセスし、`contact.index` が表示される。`resources/js/contact/category-select-loader.js` と `tag-select-loader.js` が `/api/categories` `/api/tags` を叩き、セレクト／チェックボックスへ候補が追加されること。 |
| TC-WF02 | WF02 | フロントバリデーション | 任意フィールドを空や不正値にして「確認画面」を押下すると `resources/js/validation-messages.js` に定義したエラーが表示され、確認セクションへ遷移しない。全項目を正しく入力し「確認画面」押下で確認レイアウトへ切り替わり、APIから取得したカテゴリ／タグ名が表示される。 |
| TC-WF03 | WF03 | API送信・サーババリデーション | 確認画面から送信すると `POST /api/contacts` が呼ばれ、`StoreContactRequest` のルール通過時に201を返し `/thanks` に遷移する。異常値入力で422とエラーメッセージがアラートで表示される。DBに `contacts` + `contact_tag` レコードが保存される。 |
| TC-WF04 | WF04 | Thanks画面 | `/thanks` でメッセージが表示され、HOMEリンクで `/` に戻る。 |
| TC-AF01 | AF01 | 検索・一覧・ページネーション | ログイン後 `/admin` にアクセスし、検索条件を指定して送信するとクエリがURLに反映され、`GET /api/contacts` で条件フィルターされた結果がテーブル表示される。ページリンクを操作すると `meta.links` に基づき遷移する。 |
| TC-AF02 | AF02 | 詳細表示・削除 | 管理テーブルの「詳細」を押すと `GET /api/contacts/{id}` で取得したデータがモーダルに表示される。モーダル内「削除」で confirm 後 `DELETE /api/contacts/{id}` が204を返し、一覧が再読み込みされる。 |
| TC-AF03 | AF03 | CSVエクスポート | `/admin` の検索条件を設定後「エクスポート」を押すと `/contacts/export` が同一条件で呼ばれ、CSV（BOM付）がダウンロードされる。内容にID/氏名/性別文字列/メール/電話/住所/建物/カテゴリ/詳細/作成日時が含まれる。 |
| TC-AF04-1 | AF04 | タグ登録 | 管理画面のタグ管理で名称入力→追加すると `POST /api/tags` が201を返し、一覧が再描画される。重複名で422とエラーが表示される。 |
| TC-AF04-2 | AF04 | タグ編集/削除 | リストの編集→名称変更で `PUT /api/tags/{id}` が204を返し更新される。同名既存タグ指定時はバリデーションエラー。削除ボタンで confirm 後 `DELETE /api/tags/{id}` が204を返し一覧から消える。 |
| TC-AU01 | AU01 | 管理者登録 | `/register` 画面で正しい値を入力すると `CreateNewUser` 経由でユーザーが作成され `/admin` へ遷移。必須項目欠落やパスワード不備でエラー表示。 |
| TC-AU02 | AU02 | ログイン/ログアウト | `/login` で既存ユーザー資格情報を入力すると成功し `/admin` へ。誤った組み合わせでエラーメッセージ。管理画面ヘッダの logout ボタン押下でセッションが破棄される。 |

## テーブル仕様書

### usersテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | users | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2014_10_12_000000_create_users_table.php:14` |
| 2 | users | name | varchar(255) |  | :white_check_mark: |  | 管理者氏名 |
| 3 | users | email | varchar(255) unique |  | :white_check_mark: |  | ログインID |
| 4 | users | email_verified_at | timestamp |  |  |  | null許容 |
| 5 | users | password | varchar(255) |  | :white_check_mark: |  | ハッシュ保存 |
| 6 | users | two_factor_secret | text |  |  |  | 2FA秘密鍵。`database/migrations/2014_10_12_200000_add_two_factor_columns_to_users_table.php:14` |
| 7 | users | two_factor_recovery_codes | text |  |  |  | 2FAリカバリコード |
| 8 | users | two_factor_confirmed_at | timestamp |  |  |  |  |
| 9 | users | remember_token | varchar(100) |  |  |  |  |
| 10 | users | created_at | timestamp |  |  |  | timestamps() |
| 11 | users | updated_at | timestamp |  |  |  |  |

### password_reset_tokensテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | password_reset_tokens | email | varchar(255) | :white_check_mark: | :white_check_mark: |  | `database/migrations/2014_10_12_100000_create_password_reset_tokens_table.php:12` |
| 2 | password_reset_tokens | token | varchar(255) |  | :white_check_mark: |  |  |
| 3 | password_reset_tokens | created_at | timestamp |  |  |  |  |

### personal_access_tokensテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | personal_access_tokens | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2019_12_14_000001_create_personal_access_tokens_table.php:12` |
| 2 | personal_access_tokens | tokenable_type | varchar(255) |  | :white_check_mark: |  | 多態（Sanctum） |
| 3 | personal_access_tokens | tokenable_id | bigint unsigned |  | :white_check_mark: |  |  |
| 4 | personal_access_tokens | name | varchar(255) |  | :white_check_mark: |  |  |
| 5 | personal_access_tokens | token | varchar(64) unique |  | :white_check_mark: |  |  |
| 6 | personal_access_tokens | abilities | text |  |  |  | 任意 |
| 7 | personal_access_tokens | last_used_at | timestamp |  |  |  |  |
| 8 | personal_access_tokens | expires_at | timestamp |  |  |  |  |
| 9 | personal_access_tokens | created_at | timestamp |  |  |  |  |
| 10 | personal_access_tokens | updated_at | timestamp |  |  |  |  |

### failed_jobsテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | failed_jobs | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2019_08_19_000000_create_failed_jobs_table.php:12` |
| 2 | failed_jobs | uuid | varchar(255) unique |  | :white_check_mark: |  |  |
| 3 | failed_jobs | connection | text |  | :white_check_mark: |  |  |
| 4 | failed_jobs | queue | text |  | :white_check_mark: |  |  |
| 5 | failed_jobs | payload | longtext |  | :white_check_mark: |  |  |
| 6 | failed_jobs | exception | longtext |  | :white_check_mark: |  |  |
| 7 | failed_jobs | failed_at | timestamp |  | :white_check_mark: |  | default current |

### categoriesテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | categories | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_040042_create_categories_table.php:14` |
| 2 | categories | content | varchar(255) |  | :white_check_mark: |  | 区分名 |
| 3 | categories | created_at | timestamp |  |  |  |  |
| 4 | categories | updated_at | timestamp |  |  |  |  |

### contactsテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | contacts | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_040043_create_contacts_table.php:14` |
| 2 | contacts | category_id | bigint unsigned |  | :white_check_mark: | categories.id | cascade delete |
| 3 | contacts | first_name | varchar(255) |  | :white_check_mark: |  |  |
| 4 | contacts | last_name | varchar(255) |  | :white_check_mark: |  |  |
| 5 | contacts | gender | tinyint |  | :white_check_mark: |  | 1:男性,2:女性,3:その他 |
| 6 | contacts | email | varchar(255) |  | :white_check_mark: |  |  |
| 7 | contacts | tel | varchar(11) |  | :white_check_mark: |  | ハイフンなし10〜11桁 |
| 8 | contacts | address | varchar(255) |  | :white_check_mark: |  |  |
| 9 | contacts | building | varchar(255) |  |  |  | nullable |
| 10 | contacts | detail | varchar(120) |  | :white_check_mark: |  |  |
| 11 | contacts | created_at | timestamp |  |  |  |  |
| 12 | contacts | updated_at | timestamp |  |  |  |  |

### tagsテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | tags | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_042329_create_tags_table.php:14` |
| 2 | tags | name | varchar(50) unique |  | :white_check_mark: |  |  |
| 3 | tags | created_at | timestamp |  |  |  |  |
| 4 | tags | updated_at | timestamp |  |  |  |  |

### contact_tagテーブル
| No. | テーブル名 | カラム名 | 型 | PRIMARY KEY | NOT NULL | FOREIGN KEY | 補足 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | contact_tag | id | bigint unsigned | :white_check_mark: | :white_check_mark: |  | `database/migrations/2026_02_10_042338_create_contact_tag_table.php:14` |
| 2 | contact_tag | contact_id | bigint unsigned |  | :white_check_mark: | contacts.id | cascade delete |
| 3 | contact_tag | tag_id | bigint unsigned |  | :white_check_mark: | tags.id | cascade delete |
| 4 | contact_tag | created_at | timestamp |  |  |  |  |
| 5 | contact_tag | updated_at | timestamp |  |  |  |  |
| 6 | contact_tag | (制約) | unique(contact_id, tag_id) |  |  |  | 重複付与防止（`database/migrations/2026_02_10_042338_create_contact_tag_table.php:20`） |

### failed_jobs/personal_access_tokens/password_reset_tokens
- 上記項目参照。

## 次のステップ
1. 関係者レビューを行い、追加要件やAPI認証方針の擦り合わせをしてください。
